<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Options for run_SSMSE | SSMSE user manual</title>
  <meta name="description" content="This is a user manual for the SSMSE package. It includes documentation and examples." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Options for run_SSMSE | SSMSE user manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a user manual for the SSMSE package. It includes documentation and examples." />
  <meta name="github-repo" content="nmfs-fish-tools/SSMSE" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Options for run_SSMSE | SSMSE user manual" />
  
  <meta name="twitter:description" content="This is a user manual for the SSMSE package. It includes documentation and examples." />
  

<meta name="author" content="Kathryn Doering and Nathan Vaughan" />


<meta name="date" content="2023-02-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="M-case-study-ex.html"/>
<link rel="next" href="helper.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-session-information"><i class="fa fa-check"></i>R session information</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#funs"><i class="fa fa-check"></i><b>1.2</b> Functions in SSMSE</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#brief-description-of-the-ssmse-mse-simulation-procedure-using-run_ssmse"><i class="fa fa-check"></i><b>1.3</b> Brief description of the SSMSE MSE simulation procedure using <code>run_SSMSE()</code></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#conditioning-the-om-and-sampling-from-the-om"><i class="fa fa-check"></i><b>1.3.1</b> Conditioning the OM and sampling from the OM</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#first-run-of-the-management-strategy-in-the-mse-simulation"><i class="fa fa-check"></i><b>1.3.2</b> First run of the management strategy in the MSE simulation</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#feedback-from-managment-strategy-into-om-extending-model-years"><i class="fa fa-check"></i><b>1.3.3</b> Feedback from managment strategy into OM: extending model years</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#subsequent-runs-of-the-management-strategy"><i class="fa fa-check"></i><b>1.3.4</b> Subsequent runs of the management strategy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simple.html"><a href="simple.html"><i class="fa fa-check"></i><b>2</b> A simple example</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simple.html"><a href="simple.html#setup-r-workspace-folders"><i class="fa fa-check"></i><b>2.1</b> Setup R workspace folders</a></li>
<li class="chapter" data-level="2.2" data-path="simple.html"><a href="simple.html#create-the-operating-models-oms"><i class="fa fa-check"></i><b>2.2</b> Create the operating models (OMs)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="simple.html"><a href="simple.html#specify-alternative-values-for-h"><i class="fa fa-check"></i><b>2.2.1</b> Specify alternative values for h</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="simple.html"><a href="simple.html#adding-process-error-through-recruitment-deviations-and-time-varying-selectivity"><i class="fa fa-check"></i><b>2.3</b> Adding process error through recruitment deviations and time-varying selectivity</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simple.html"><a href="simple.html#add-observation-error-through-sampling-from-om"><i class="fa fa-check"></i><b>2.3.1</b> Add observation error through sampling from OM</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simple.html"><a href="simple.html#examine-the-management-procedure-used"><i class="fa fa-check"></i><b>2.4</b> Examine the management procedure used</a></li>
<li class="chapter" data-level="2.5" data-path="simple.html"><a href="simple.html#run-ssmse"><i class="fa fa-check"></i><b>2.5</b> Run SSMSE</a></li>
<li class="chapter" data-level="2.6" data-path="simple.html"><a href="simple.html#run_ssmse-output"><i class="fa fa-check"></i><b>2.6</b> run_SSMSE output</a></li>
<li class="chapter" data-level="2.7" data-path="simple.html"><a href="simple.html#performance-metrics"><i class="fa fa-check"></i><b>2.7</b> Performance metrics</a></li>
<li class="chapter" data-level="2.8" data-path="simple.html"><a href="simple.html#summarize-results"><i class="fa fa-check"></i><b>2.8</b> Summarize results</a></li>
<li class="chapter" data-level="2.9" data-path="simple.html"><a href="simple.html#simple-convergence-check"><i class="fa fa-check"></i><b>2.9</b> Simple Convergence Check</a></li>
<li class="chapter" data-level="2.10" data-path="simple.html"><a href="simple.html#plot-spawning-stock-biomass-ssb"><i class="fa fa-check"></i><b>2.10</b> Plot Spawning Stock Biomass (SSB)</a></li>
<li class="chapter" data-level="2.11" data-path="simple.html"><a href="simple.html#example-mse-results"><i class="fa fa-check"></i><b>2.11</b> Example MSE Results</a></li>
<li class="chapter" data-level="2.12" data-path="simple.html"><a href="simple.html#delete-the-files"><i class="fa fa-check"></i><b>2.12</b> Delete the files</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="advanced-options-use-a-custom-management-strategyprocedure.html"><a href="advanced-options-use-a-custom-management-strategyprocedure.html"><i class="fa fa-check"></i><b>3</b> Advanced options: use a custom management strategy/procedure</a></li>
<li class="chapter" data-level="4" data-path="M-case-study-ex.html"><a href="M-case-study-ex.html"><i class="fa fa-check"></i><b>4</b> A more complex example, Natural Mortality case study</a></li>
<li class="chapter" data-level="5" data-path="SSMSE.html"><a href="SSMSE.html"><i class="fa fa-check"></i><b>5</b> Options for run_SSMSE</a>
<ul>
<li class="chapter" data-level="5.1" data-path="SSMSE.html"><a href="SSMSE.html#scenarios-in-ssmse"><i class="fa fa-check"></i><b>5.1</b> Scenarios in SSMSE</a></li>
<li class="chapter" data-level="5.2" data-path="SSMSE.html"><a href="SSMSE.html#operating-model"><i class="fa fa-check"></i><b>5.2</b> Operating model</a></li>
<li class="chapter" data-level="5.3" data-path="SSMSE.html"><a href="SSMSE.html#the-management-strategy-and-if-applicable-estimation-model-em"><i class="fa fa-check"></i><b>5.3</b> The Management Strategy and (if applicable) Estimation model (EM)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="SSMSE.html"><a href="SSMSE.html#specify-the-management-strategy-in-a-ss3-model"><i class="fa fa-check"></i><b>5.3.1</b> Specify the Management Strategy in a SS3 model</a></li>
<li class="chapter" data-level="5.3.2" data-path="SSMSE.html"><a href="SSMSE.html#custom-MS"><i class="fa fa-check"></i><b>5.3.2</b> Using a custom management strategy/procedure</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="SSMSE.html"><a href="SSMSE.html#sampling-options"><i class="fa fa-check"></i><b>5.4</b> Sampling options</a></li>
<li class="chapter" data-level="5.5" data-path="SSMSE.html"><a href="SSMSE.html#future-changes-to-the-operating-model-future"><i class="fa fa-check"></i><b>5.5</b> Future changes to the operating model (#future)</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="SSMSE.html"><a href="SSMSE.html#the-strucutre-of-future_om_list"><i class="fa fa-check"></i><b>5.5.1</b> The strucutre of <code>future_om_list</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="SSMSE.html"><a href="SSMSE.html#example-of-future_om_list-denoting-a-gradual-change"><i class="fa fa-check"></i><b>5.5.2</b> Example of future_om_list denoting a gradual change</a></li>
<li class="chapter" data-level="5.5.3" data-path="SSMSE.html"><a href="SSMSE.html#example-of-future_om_list-with-random-deviations"><i class="fa fa-check"></i><b>5.5.3</b> Example of future_om_list with random deviations</a></li>
<li class="chapter" data-level="5.5.4" data-path="SSMSE.html"><a href="SSMSE.html#example-of-using-historical-values-for-determining-parameter-values"><i class="fa fa-check"></i><b>5.5.4</b> Example of using historical values for determining parameter values</a></li>
<li class="chapter" data-level="5.5.5" data-path="SSMSE.html"><a href="SSMSE.html#example-using-custom-pattern-instead-of-model_change"><i class="fa fa-check"></i><b>5.5.5</b> Example using “custom” pattern instead of “model_change”</a></li>
<li class="chapter" data-level="5.5.6" data-path="SSMSE.html"><a href="SSMSE.html#how-is-the-operating-modified-to-accomodate-changes-as-specified-in-the-future_om_list"><i class="fa fa-check"></i><b>5.5.6</b> How is the operating modified to accomodate changes as specified in the future_OM_list?</a></li>
<li class="chapter" data-level="5.5.7" data-path="SSMSE.html"><a href="SSMSE.html#example-of-specifying-recruitment-deviations"><i class="fa fa-check"></i><b>5.5.7</b> Example of specifying recruitment deviations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="helper.html"><a href="helper.html"><i class="fa fa-check"></i><b>6</b> Helper functions in SSMSE</a>
<ul>
<li class="chapter" data-level="6.1" data-path="helper.html"><a href="helper.html#devOM"><i class="fa fa-check"></i><b>6.1</b> Creating multiple operating models with <code>develop_OMs()</code></a></li>
<li class="chapter" data-level="6.2" data-path="helper.html"><a href="helper.html#samplelist"><i class="fa fa-check"></i><b>6.2</b> Set up sampling for a scenario with <code>create_sample_struct()</code></a></li>
<li class="chapter" data-level="6.3" data-path="helper.html"><a href="helper.html#omlist"><i class="fa fa-check"></i><b>6.3</b> Get examples of the <code>future_om_list</code> input with <code>create_future_om_list()</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="output.html"><a href="output.html"><i class="fa fa-check"></i><b>7</b> Output and Plots</a>
<ul>
<li class="chapter" data-level="7.1" data-path="output.html"><a href="output.html#summarizing-output"><i class="fa fa-check"></i><b>7.1</b> Summarizing output</a></li>
<li class="chapter" data-level="7.2" data-path="output.html"><a href="output.html#checking-estimation-model-convergence"><i class="fa fa-check"></i><b>7.2</b> Checking estimation model convergence</a></li>
<li class="chapter" data-level="7.3" data-path="output.html"><a href="output.html#calculating-performance-metrics"><i class="fa fa-check"></i><b>7.3</b> Calculating performance metrics</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="plotting-output-and-performance-metrics.html"><a href="plotting-output-and-performance-metrics.html"><i class="fa fa-check"></i><b>8</b> Plotting output and performance metrics</a></li>
<li class="chapter" data-level="9" data-path="glossary-of-mse-terms.html"><a href="glossary-of-mse-terms.html"><i class="fa fa-check"></i><b>9</b> Glossary of MSE terms</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SSMSE user manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SSMSE" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Options for run_SSMSE<a href="SSMSE.html#SSMSE" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Many inputs are possible for the <code>run_SSMSE()</code> option. Here, we will describe some of the options available. For detailed documentation, type <code>?SSMSE::run_SSMSE()</code> into the R console.</p>
<div id="scenarios-in-ssmse" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Scenarios in SSMSE<a href="SSMSE.html#scenarios-in-ssmse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Note that multiple scenarios can be called in <code>run_SSMSE()</code>, often through vector inputs to <code>run_SSMSE()</code>. Below, we will describe inputs needed to run 1 scenario.</p>
</div>
<div id="operating-model" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Operating model<a href="SSMSE.html#operating-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The operating model (OM) for SSMSE should be a Stock Synthesis model. This could be any fitted Stock Synthesis model, except for models that use Empirical Weight at age.
There are 3 built-in models that comes with SSMSE: cod, growth_timevary, and SR_env_block. To use a built in model, specify the name of the model as part of the <code>OM_name_vec</code>. For example, to use the cod model in run_SSMSE for 1 scenario, set <code>OM_name_vec = "cod"</code>. Otherwise, the path to the OM model should be specified in <code>OM_in_dir_vec</code>.</p>
</div>
<div id="the-management-strategy-and-if-applicable-estimation-model-em" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> The Management Strategy and (if applicable) Estimation model (EM)<a href="SSMSE.html#the-management-strategy-and-if-applicable-estimation-model-em" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The management strategy (and EM) can be specified in one of two ways:</p>
<ol style="list-style-type: decimal">
<li>Using an SS3 model and its forcast file to project catch by fleet</li>
<li>Using a custom management strategy via a function in R</li>
</ol>
<p>In theory, any management strategy should work, as long as it can take the data file produced by the OM as output and provide back to SSMSE future catches by fleet.</p>
<div id="specify-the-management-strategy-in-a-ss3-model" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Specify the Management Strategy in a SS3 model<a href="SSMSE.html#specify-the-management-strategy-in-a-ss3-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An SS3 model can be set up as the EM for the MSE. To use this option, specify <code>"EM"</code> as part of <code>MS_vec</code>. As with the OM, the built-in cod model could be used; just specify <code>"cod"</code> in the <code>EM_name_vec</code>. To use any other SS3 model as the EM, specify the path in <code>EM_in_dir_vec</code>.Note that models that use empirical weight at age can not yet be used as estimation models. Also, the .ss_new input files are used for an OM, while the original input files are used for the EM.</p>
<p>Future catches will be determined from the forecasting file settings of the SS3 model. SSMSE will change the number of forecast years to match the number of years between assessments, but other specifications need to be made by the user.</p>
</div>
<div id="custom-MS" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Using a custom management strategy/procedure<a href="SSMSE.html#custom-MS" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Users can outline a custom managment strategy as an R function to use. As long as the correct inputs and outputs are used, any estimation method and management procedure can be used. For example, here is a simple function that just sets future catches as half the sampled catches in a specified year:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="SSMSE.html#cb47-1" aria-hidden="true" tabindex="-1"></a>constant_catch_MS <span class="ot">&lt;-</span> <span class="cf">function</span>(OM_dat, nyrs_assess, <span class="at">catch_yr =</span> <span class="dv">100</span>, </span>
<span id="cb47-2"><a href="SSMSE.html#cb47-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frac_catch =</span> <span class="fl">0.5</span>, ...) { <span class="co"># need to include ... to allow function to work</span></span>
<span id="cb47-3"><a href="SSMSE.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set catch the same as the previous year (sampled catch).</span></span>
<span id="cb47-4"><a href="SSMSE.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># catch is in the same units as the operating model, in this case it is in</span></span>
<span id="cb47-5"><a href="SSMSE.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># biomass.</span></span>
<span id="cb47-6"><a href="SSMSE.html#cb47-6" aria-hidden="true" tabindex="-1"></a>  catch <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-7"><a href="SSMSE.html#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> (OM_dat<span class="sc">$</span>endyr <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(OM_dat<span class="sc">$</span>endyr <span class="sc">+</span> nyrs_assess), <span class="co"># the years to project the model forward</span></span>
<span id="cb47-8"><a href="SSMSE.html#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">seas =</span> <span class="dv">1</span>, <span class="co"># hard coded from looking at model </span></span>
<span id="cb47-9"><a href="SSMSE.html#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fleet =</span> <span class="dv">1</span>,  <span class="co"># hard coded from looking at model</span></span>
<span id="cb47-10"><a href="SSMSE.html#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">catch =</span> OM_dat<span class="sc">$</span>catch[OM_dat<span class="sc">$</span>catch<span class="sc">$</span>year <span class="sc">==</span> catch_yr, <span class="st">&quot;catch&quot;</span>]<span class="sc">*</span>frac_catch,</span>
<span id="cb47-11"><a href="SSMSE.html#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">catch_se =</span> <span class="fl">0.05</span>) <span class="co"># hard coded from looking at model</span></span>
<span id="cb47-12"><a href="SSMSE.html#cb47-12" aria-hidden="true" tabindex="-1"></a>  catch_bio <span class="ot">&lt;-</span> catch <span class="co"># catch in biomass. In this case, catch is in biomass for both. Could also be left as NULL</span></span>
<span id="cb47-13"><a href="SSMSE.html#cb47-13" aria-hidden="true" tabindex="-1"></a>  catch_F <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># catch in terms of F, can be left as NULL.</span></span>
<span id="cb47-14"><a href="SSMSE.html#cb47-14" aria-hidden="true" tabindex="-1"></a>  discards <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># discards can be left as NULL if there are no discards</span></span>
<span id="cb47-15"><a href="SSMSE.html#cb47-15" aria-hidden="true" tabindex="-1"></a>  catch_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">catch =</span> catch,</span>
<span id="cb47-16"><a href="SSMSE.html#cb47-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">catch_bio =</span> catch_bio, </span>
<span id="cb47-17"><a href="SSMSE.html#cb47-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">catch_F =</span> catch_F,</span>
<span id="cb47-18"><a href="SSMSE.html#cb47-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discards =</span> discards)</span>
<span id="cb47-19"><a href="SSMSE.html#cb47-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s assume this function is saved in a file within the working directory named constant_catch_MS.R.</p>
<p>This function can then be used in a call to <code>run_SSMSE()</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="SSMSE.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define sample structure</span></span>
<span id="cb48-2"><a href="SSMSE.html#cb48-2" aria-hidden="true" tabindex="-1"></a>datfile <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;models&quot;</span>, <span class="st">&quot;cod&quot;</span>, <span class="st">&quot;ss3.dat&quot;</span>, <span class="at">package =</span> <span class="st">&quot;SSMSE&quot;</span>)</span>
<span id="cb48-3"><a href="SSMSE.html#cb48-3" aria-hidden="true" tabindex="-1"></a>sample_struct <span class="ot">&lt;-</span> <span class="fu">create_sample_struct</span>(<span class="at">dat =</span> datfile, <span class="at">nyrs =</span> <span class="dv">6</span>) <span class="co"># note warning</span></span>
<span id="cb48-4"><a href="SSMSE.html#cb48-4" aria-hidden="true" tabindex="-1"></a>sample_struct<span class="sc">$</span>lencomp <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># don&#39;t use length sampling</span></span>
<span id="cb48-5"><a href="SSMSE.html#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="SSMSE.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># run the SSMSE routine</span></span>
<span id="cb48-7"><a href="SSMSE.html#cb48-7" aria-hidden="true" tabindex="-1"></a>run_result_custom <span class="ot">&lt;-</span> <span class="fu">run_SSMSE</span>(</span>
<span id="cb48-8"><a href="SSMSE.html#cb48-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">scen_name_vec =</span> <span class="st">&quot;constant-catch&quot;</span>,</span>
<span id="cb48-9"><a href="SSMSE.html#cb48-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">out_dir_scen_vec =</span> <span class="st">&quot;my_results&quot;</span>,</span>
<span id="cb48-10"><a href="SSMSE.html#cb48-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">iter_vec =</span> <span class="dv">1</span>,</span>
<span id="cb48-11"><a href="SSMSE.html#cb48-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">OM_name_vec =</span> <span class="st">&quot;cod&quot;</span>,</span>
<span id="cb48-12"><a href="SSMSE.html#cb48-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">OM_in_dir_vec =</span> <span class="cn">NULL</span>,</span>
<span id="cb48-13"><a href="SSMSE.html#cb48-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">MS_vec =</span> <span class="st">&quot;constant_catch_MS&quot;</span>, <span class="co"># use custom fun</span></span>
<span id="cb48-14"><a href="SSMSE.html#cb48-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">custom_MS_source =</span> <span class="st">&quot;constant_catch_MS.R&quot;</span>,</span>
<span id="cb48-15"><a href="SSMSE.html#cb48-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">use_SS_boot_vec =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-16"><a href="SSMSE.html#cb48-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">nyrs_vec =</span> <span class="dv">6</span>,</span>
<span id="cb48-17"><a href="SSMSE.html#cb48-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">nyrs_assess_vec =</span> <span class="dv">3</span>,</span>
<span id="cb48-18"><a href="SSMSE.html#cb48-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">run_EM_last_yr =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-19"><a href="SSMSE.html#cb48-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">run_parallel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-20"><a href="SSMSE.html#cb48-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sample_struct_list =</span> <span class="fu">list</span>(sample_struct),</span>
<span id="cb48-21"><a href="SSMSE.html#cb48-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">seed =</span> <span class="dv">12345</span>)</span></code></pre></div>
</div>
</div>
<div id="sampling-options" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Sampling options<a href="SSMSE.html#sampling-options" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Currently, the only available sampling option is to use the bootstrapping module within SS3 itself. This means specifying <code>use_SS_boot_vec = TRUE</code>. Details on how sampling is done using the bootstrapping module in SS3 is available in the “Bootstrap Data Files” section of the <a href="https://vlab.noaa.gov/web/stock-synthesis/document-library/-/document_library/0LmuycloZeIt/view_file/11684231">SS3 user manual</a>.</p>
<p>Users also need to specify how and which data types should be sampled for each future year in the simulation in <code>sample_struct_list</code>. <code>sample_struct_list</code> is a list of lists. The first level is a list for each scenario; then, for the scenario, there is a list of dataframes, each of which specifying which years and fleets of data should be sampled in the future as well as which standard errors or sample sizes should be used.</p>
<p>The helper function <code>create_sample_struct()</code> can be used to help users generate the list of dataframes for a scenario. See an example of this function’s use in the <a href="#sample">simple example</a> or by typing <code>?SSMSE::create_sample_struct()</code> into the R console.</p>
<p>Currently, users can sample data for catches (treated as fixed if <code>sample_catch = FALSE</code> for the scenario), CPUE (i.e., indices of abundance), length and age composition, conditional length at age compositions, mean size at age, and mean size. It is not yet possible to sample data for generalized size compositions, tagging data, and morph compositions.</p>
<p>Users can specify the sampling during the historical period of the model through the <code>sample_struct_hist</code> input to <code>run_SSMSE</code>. This is an optional input and has the same structure as <code>sample_struct_list</code>, but the years will be before the original end year of the OM.</p>
</div>
<div id="future-changes-to-the-operating-model-future" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Future changes to the operating model (#future)<a href="SSMSE.html#future-changes-to-the-operating-model-future" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By default, SSMSE will simply extend the structure of the OM into the future using the same parameter values as in the last year of the model. However, the user may want to allow changes in parameter values to occur as the OM is extended forward in time. Users can input values into the <code>future_om_list</code> to accomplish this. This input is a list of lists. For the first level of lists, each represents a separate change to make. Within the first level, there are 4 list components that outline the details of the change to make. There are 2 main choices: 1) to specify model changes by telling SSMSE how values should be sampled or 2) to input your own custom values for future values of a given parameter.</p>
<div id="the-strucutre-of-future_om_list" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> The strucutre of <code>future_om_list</code><a href="SSMSE.html#the-strucutre-of-future_om_list" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For example, here is an example list containing just one future change for the model. It shows that the model should be changed to 4.5 in year 103 and afterwards:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="SSMSE.html#cb49-1" aria-hidden="true" tabindex="-1"></a>my_future_om_list <span class="ot">&lt;-</span> <span class="fu">create_future_om_list</span>(<span class="at">list_length =</span> <span class="dv">1</span>)</span>
<span id="cb49-2"><a href="SSMSE.html#cb49-2" aria-hidden="true" tabindex="-1"></a>my_future_om_list</span></code></pre></div>
<pre><code>[[1]]
[[1]]$pars
[1] &quot;SizeSel_P_3_Fishery(1)&quot;

[[1]]$scen
[1] &quot;replicate&quot; &quot;scen2&quot;    

[[1]]$pattern
[1] &quot;model_change&quot;

[[1]]$input
  first_yr_averaging last_yr_averaging last_yr_orig_val first_yr_final_val
1                 NA                NA              102                103
  ts_param   method value
1     mean absolute   4.5</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="SSMSE.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(my_future_om_list) <span class="co"># note has length 1 b/c 1 change</span></span></code></pre></div>
<pre><code>[1] 1</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="SSMSE.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(my_future_om_list[[<span class="dv">1</span>]]) <span class="co"># has length 4 because 4 list components, as for each change</span></span></code></pre></div>
<pre><code>[1] 4</code></pre>
<p>Note there is just one change specified here. For the change, there are four list items that are required for any specified change.</p>
<ol style="list-style-type: decimal">
<li>The first list item is named “pars”. It contains a vector of parameter name(s) to apply the change to. The names should be the same as the names in <code>r4ss::SS_read_pars()</code> or can include the following:</li>
</ol>
<ul>
<li><code>"rec_devs"</code> - For specifying recruitment deviations</li>
<li><code>"impl_error</code> - For specifying implementation error in transforming a management procedure’s specified future catch into realized catch.</li>
<li><code>"all"</code> - Apply the change to all parameters in the model, with the exception of “SR_sigmaR”, “SR_regime”, “SR_autocorr”, and “impl_error” parameters. Changing the first 3 stock recruitment related parameters would conflict with changes in recruitment deviations. Since implementation error is not a parameter specified in the control file and SSMSE does not rely on the implementation error parameter created through the forecasting file, including the implementation error in “all” did not seem appropriate.</li>
</ul>
<p>In this case, we just want to apply the change to the <code>SizeSel_P_3_Fishery(1)</code> parameter of the model.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>The second item is “scen”, which contains a vector of information about how to apply the changes within and across scenarios. The first value is an option to specify how the change should be applied among scenarios, either “randomize” (use a different value for each iteration of each scenario) or “replicate” (use the same set of values across scenarios for the same number iteration, but each value will be different across iterations within the same scenario). Note that the same values will be applied across iterations and scenarios if there isn’t any stochasticity in the values being drawn (e.g., standard deviation set at 0), regardless if “randomize” or “replicate” is chosen. In the example above, there is no stochasticity, so specifying randomize or replicate does not matter. Following the first value are the names of the scenarios to apply the change to. If the change should be applied to all of the scenarios, “all” can be used in place of naming every scenario. In this example, The change will only be applied to the scenario named “scen2”, so the input for “scen” is <code>c("randomize", "scen2")</code>.</p></li>
<li><p>The “pattern” is a vector of character inputs. The first value should be either “model_change”, meaning that SSMSE will calculate the change values, or “custom” which allows the user to directly put in the values that they want in the model. In this case, “model_change” is used. A second input can also be added when the “model_change” pattern is used, which specifies the distribution to pull from. This could be “normal” or “lognormal”, but if no input is provided, a normal distribution will be used for sampling.</p></li>
<li><p>The fourth item, named “input”, is a dataframe, which contains different column name values depending on if the “model_change” pattern is used or if the “custom” pattern is used. For the model_change options, a dataframe in input specifies a change for the parameter of a distribution. Because we are using the model change option, we have the following columns:</p></li>
</ol>
<ul>
<li><code>first_yr_averaging</code>: The first year to average historical values from the model, if using for the change. This should be <code>NA</code> if historical averaging will not be used.</li>
<li><code>last_yr_averaging</code>: The last year to average historical values from the model, if using for the change. This should be <code>NA</code> if historical averaging will not be used.</li>
<li><code>last_yr_orig_val</code>: The last year of the future deviations with the original model value. This value will not be changed, but the following year’s value will be.</li>
<li><code>first_yr_final_val</code>: The first year where the final value as specified will be reached. If no future changes are made, the final value will continue forward in the OM through all projected years. For step changes, the <code>first_yr_final_val</code> is just 1 year after the <code>last_yr_orig_val</code>. However, if a more gradual adjustment toward the final value is desired, this could be any number of years after the original value.</li>
<li>ts_param: The sampling parameter to modify. Options are “mean”, “ar_1_phi” (if using autocorrelation), “sd”, and “cv”. If not included in the dataframe, “mean” is assumed to be the same as in the previous model year, sd is assumed to be 0, and we assume no autocorrelation (as specified through an autoregressive AR1 process). Phi should be between -1 and 1 (this creates a stationary process) and if phi = 1, this creates a random walk (as random walk is a special case of an AR1 model). Note that both sd and cv cannot be specified within the same input dataframe.</li>
<li>method: How to apply the change relative to the historical (if specified) or previous year’s value (if first_yr_averaging and last_yr_averaging for that row are NA). Options are “multiplicative”, “additive”, and “absolute”. This example uses “absolute”, meaning that the number in “value” is directly used.</li>
<li>value. The value of the parameter change. This may be NA if historical averaging is used.</li>
</ul>
</div>
<div id="example-of-future_om_list-denoting-a-gradual-change" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Example of future_om_list denoting a gradual change<a href="SSMSE.html#example-of-future_om_list-denoting-a-gradual-change" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we wanted to change the value of “SizeSel_P_3_Fishery(1)” in scen2 over 4 years after year 102 to arrive at a value of 4.5 in year 106. We can do this by using <code>my_future_om_list</code>, but changing the value in the first row of <code>first_yr_final_val</code> to 106:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="SSMSE.html#cb55-1" aria-hidden="true" tabindex="-1"></a>my_future_om_list[[<span class="dv">1</span>]][[<span class="st">&quot;input&quot;</span>]][<span class="dv">1</span>, <span class="st">&quot;first_yr_final_val&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">106</span></span>
<span id="cb55-2"><a href="SSMSE.html#cb55-2" aria-hidden="true" tabindex="-1"></a>my_future_om_list[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>$pars
[1] &quot;SizeSel_P_3_Fishery(1)&quot;

$scen
[1] &quot;replicate&quot; &quot;scen2&quot;    

$pattern
[1] &quot;model_change&quot;

$input
  first_yr_averaging last_yr_averaging last_yr_orig_val first_yr_final_val
1                 NA                NA              102                106
  ts_param   method value
1     mean absolute   4.5</code></pre>
</div>
<div id="example-of-future_om_list-with-random-deviations" class="section level3 hasAnchor" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Example of future_om_list with random deviations<a href="SSMSE.html#example-of-future_om_list-with-random-deviations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we now wanted the value of “SizeSel_P_3_Fishery(1)” to change randomly according to a normal distribution with a standard deviation of 0.1 around a mean of 4.5 from 104 onwards. This can be done by adding a line specifying a change in standard deviation (which for now, has been assumed to be 0) to the data frame:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="SSMSE.html#cb57-1" aria-hidden="true" tabindex="-1"></a>new_vals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">first_yr_averaging =</span> <span class="cn">NA</span>,</span>
<span id="cb57-2"><a href="SSMSE.html#cb57-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">last_yr_averaging  =</span> <span class="cn">NA</span>, </span>
<span id="cb57-3"><a href="SSMSE.html#cb57-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">last_yr_orig_val   =</span> <span class="dv">103</span>,</span>
<span id="cb57-4"><a href="SSMSE.html#cb57-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">first_yr_final_val =</span> <span class="dv">104</span>, </span>
<span id="cb57-5"><a href="SSMSE.html#cb57-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ts_param =</span> <span class="st">&quot;sd&quot;</span>, </span>
<span id="cb57-6"><a href="SSMSE.html#cb57-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;absolute&quot;</span>,</span>
<span id="cb57-7"><a href="SSMSE.html#cb57-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">value =</span> <span class="fl">0.1</span>)</span>
<span id="cb57-8"><a href="SSMSE.html#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="SSMSE.html#cb57-9" aria-hidden="true" tabindex="-1"></a>my_future_om_list[[<span class="dv">1</span>]][[<span class="st">&quot;input&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">rbind</span>(my_future_om_list[[<span class="dv">1</span>]][[<span class="st">&quot;input&quot;</span>]],</span>
<span id="cb57-10"><a href="SSMSE.html#cb57-10" aria-hidden="true" tabindex="-1"></a>                                           new_vals)</span>
<span id="cb57-11"><a href="SSMSE.html#cb57-11" aria-hidden="true" tabindex="-1"></a>my_future_om_list[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>$pars
[1] &quot;SizeSel_P_3_Fishery(1)&quot;

$scen
[1] &quot;replicate&quot; &quot;scen2&quot;    

$pattern
[1] &quot;model_change&quot;

$input
  first_yr_averaging last_yr_averaging last_yr_orig_val first_yr_final_val
1                 NA                NA              102                106
2                 NA                NA              103                104
  ts_param   method value
1     mean absolute   4.5
2       sd absolute   0.1</code></pre>
<p>Note that the <code>last_yr_orig_val</code> and <code>first_yr_final_val</code> are different than the line for the mean, which is allowed.</p>
</div>
<div id="example-of-using-historical-values-for-determining-parameter-values" class="section level3 hasAnchor" number="5.5.4">
<h3><span class="header-section-number">5.5.4</span> Example of using historical values for determining parameter values<a href="SSMSE.html#example-of-using-historical-values-for-determining-parameter-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This example applies random annual deviations to all parameters for scenarios scen2 and scen3.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="SSMSE.html#cb59-1" aria-hidden="true" tabindex="-1"></a>future_om_list_2 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="dv">1</span>)</span>
<span id="cb59-2"><a href="SSMSE.html#cb59-2" aria-hidden="true" tabindex="-1"></a>future_om_list_2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(future_om_list_2, <span class="cf">function</span> (x) x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="dv">4</span>))</span>
<span id="cb59-3"><a href="SSMSE.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(future_om_list_2[[<span class="dv">1</span>]]) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pars&quot;</span>, <span class="st">&quot;scen&quot;</span>, <span class="st">&quot;pattern&quot;</span>, <span class="st">&quot;input&quot;</span>)</span>
<span id="cb59-4"><a href="SSMSE.html#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="SSMSE.html#cb59-5" aria-hidden="true" tabindex="-1"></a>future_om_list_2[[<span class="dv">1</span>]][[<span class="st">&quot;pars&quot;</span>]] <span class="ot">&lt;-</span> <span class="st">&quot;all&quot;</span></span>
<span id="cb59-6"><a href="SSMSE.html#cb59-6" aria-hidden="true" tabindex="-1"></a>future_om_list_2[[<span class="dv">1</span>]][[<span class="st">&quot;scen&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;randomize&quot;</span>, <span class="st">&quot;scen2&quot;</span>, <span class="st">&quot;scen3&quot;</span>)</span>
<span id="cb59-7"><a href="SSMSE.html#cb59-7" aria-hidden="true" tabindex="-1"></a>future_om_list_2[[<span class="dv">1</span>]][[<span class="st">&quot;pattern&quot;</span>]] <span class="ot">&lt;-</span> <span class="st">&quot;model_change&quot;</span> <span class="co"># defaults to using normal dist</span></span>
<span id="cb59-8"><a href="SSMSE.html#cb59-8" aria-hidden="true" tabindex="-1"></a>future_om_list_2[[<span class="dv">1</span>]][[<span class="st">&quot;input&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">first_yr_averaging =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb59-9"><a href="SSMSE.html#cb59-9" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">last_yr_averaging =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>),</span>
<span id="cb59-10"><a href="SSMSE.html#cb59-10" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">last_yr_orig_val =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>),</span>
<span id="cb59-11"><a href="SSMSE.html#cb59-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">first_yr_final_val =</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">101</span>), </span>
<span id="cb59-12"><a href="SSMSE.html#cb59-12" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">ts_param =</span> <span class="fu">c</span>(<span class="st">&quot;cv&quot;</span>, <span class="st">&quot;mean&quot;</span>),</span>
<span id="cb59-13"><a href="SSMSE.html#cb59-13" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;absolute&quot;</span>, <span class="st">&quot;multiplier&quot;</span>), </span>
<span id="cb59-14"><a href="SSMSE.html#cb59-14" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>Note that the choice of year range for historical values does not matter unless the parameter is already time-varying in the original operating model or has become time varying through a previous change. Otherwise, the base model parameter will be applied. If no historical years are included, then the base parameter value will be the basis of comparison for relative changes (i.e., method = multiplier or additive).</p>
</div>
<div id="example-using-custom-pattern-instead-of-model_change" class="section level3 hasAnchor" number="5.5.5">
<h3><span class="header-section-number">5.5.5</span> Example using “custom” pattern instead of “model_change”<a href="SSMSE.html#example-using-custom-pattern-instead-of-model_change" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="SSMSE.html#cb60-1" aria-hidden="true" tabindex="-1"></a>custom_future_om_list <span class="ot">&lt;-</span> <span class="fu">create_future_om_list</span>(<span class="at">example_type =</span> <span class="st">&quot;custom&quot;</span>, </span>
<span id="cb60-2"><a href="SSMSE.html#cb60-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">list_length =</span> <span class="dv">1</span>)</span>
<span id="cb60-3"><a href="SSMSE.html#cb60-3" aria-hidden="true" tabindex="-1"></a>custom_future_om_list</span></code></pre></div>
<pre><code>[[1]]
[[1]]$pars
[1] &quot;impl_error&quot;

[[1]]$scen
[1] &quot;randomize&quot; &quot;all&quot;      

[[1]]$pattern
[1] &quot;custom&quot;

[[1]]$input
          par  scen iter  yr value
1  impl_error scen1    1 101  1.05
2  impl_error scen1    2 101  1.05
3  impl_error scen1    3 101  1.05
4  impl_error scen1    4 101  1.05
5  impl_error scen1    5 101  1.05
6  impl_error scen1    1 102  1.05
7  impl_error scen1    2 102  1.05
8  impl_error scen1    3 102  1.05
9  impl_error scen1    4 102  1.05
10 impl_error scen1    5 102  1.05
11 impl_error scen1    1 103  1.05
12 impl_error scen1    2 103  1.05
13 impl_error scen1    3 103  1.05
14 impl_error scen1    4 103  1.05
15 impl_error scen1    5 103  1.05
16 impl_error scen1    1 104  1.05
17 impl_error scen1    2 104  1.05
18 impl_error scen1    3 104  1.05
19 impl_error scen1    4 104  1.05
20 impl_error scen1    5 104  1.05
21 impl_error scen1    1 105  1.05
22 impl_error scen1    2 105  1.05
23 impl_error scen1    3 105  1.05
24 impl_error scen1    4 105  1.05
25 impl_error scen1    5 105  1.05
26 impl_error scen1    1 106  1.05
27 impl_error scen1    2 106  1.05
28 impl_error scen1    3 106  1.05
29 impl_error scen1    4 106  1.05
30 impl_error scen1    5 106  1.05
31 impl_error scen2    1 101  1.10
32 impl_error scen2    2 101  1.10
33 impl_error scen2    3 101  1.10
34 impl_error scen2    4 101  1.10
35 impl_error scen2    5 101  1.10
36 impl_error scen2    1 102  1.10
37 impl_error scen2    2 102  1.10
38 impl_error scen2    3 102  1.10
39 impl_error scen2    4 102  1.10
40 impl_error scen2    5 102  1.10
41 impl_error scen2    1 103  1.10
42 impl_error scen2    2 103  1.10
43 impl_error scen2    3 103  1.10
44 impl_error scen2    4 103  1.10
45 impl_error scen2    5 103  1.10
46 impl_error scen2    1 104  1.10
47 impl_error scen2    2 104  1.10
48 impl_error scen2    3 104  1.10
49 impl_error scen2    4 104  1.10
50 impl_error scen2    5 104  1.10
51 impl_error scen2    1 105  1.10
52 impl_error scen2    2 105  1.10
53 impl_error scen2    3 105  1.10
54 impl_error scen2    4 105  1.10
55 impl_error scen2    5 105  1.10
56 impl_error scen2    1 106  1.10
57 impl_error scen2    2 106  1.10
58 impl_error scen2    3 106  1.10
59 impl_error scen2    4 106  1.10
60 impl_error scen2    5 106  1.10
61 impl_error scen3    1 101  1.10
62 impl_error scen3    2 101  1.10
63 impl_error scen3    3 101  1.10
64 impl_error scen3    4 101  1.10
65 impl_error scen3    5 101  1.10
66 impl_error scen3    1 102  1.10
67 impl_error scen3    2 102  1.10
68 impl_error scen3    3 102  1.10
69 impl_error scen3    4 102  1.10
70 impl_error scen3    5 102  1.10
71 impl_error scen3    1 103  1.10
72 impl_error scen3    2 103  1.10
73 impl_error scen3    3 103  1.10
74 impl_error scen3    4 103  1.10
75 impl_error scen3    5 103  1.10
76 impl_error scen3    1 104  1.10
77 impl_error scen3    2 104  1.10
78 impl_error scen3    3 104  1.10
79 impl_error scen3    4 104  1.10
80 impl_error scen3    5 104  1.10
81 impl_error scen3    1 105  1.10
82 impl_error scen3    2 105  1.10
83 impl_error scen3    3 105  1.10
84 impl_error scen3    4 105  1.10
85 impl_error scen3    5 105  1.10
86 impl_error scen3    1 106  1.10
87 impl_error scen3    2 106  1.10
88 impl_error scen3    3 106  1.10
89 impl_error scen3    4 106  1.10
90 impl_error scen3    5 106  1.10</code></pre>
<p>The inputs required for <code>pattern = custom</code> are similar to using <code>pattern = model_change</code>, but there is no need to specify a distribution as the second vector input of “pattern” and the column names in input are different. Also that the change is “randomized”, which indicates that a value for each scenario and each iteration are necessary, whereas if the first value of “scen” was “replicate”, separate values for each scenario should not be specified, but rather a single value for “all” should be used. The columns in the dataframe are:</p>
<ul>
<li>par: the parameter name or “all” if it should be applied to all parameters in the “pars” input</li>
<li>scen: which scenario the value should apply to, or “all” if “replicate” is used as the scenario input</li>
<li>iter: which number iteration the value should apply to. These are absolute iteration numbers.</li>
<li>yr: the year the value applies to. These should be after the original end year of the OM.</li>
<li>value: the value to apply to the model</li>
</ul>
</div>
<div id="how-is-the-operating-modified-to-accomodate-changes-as-specified-in-the-future_om_list" class="section level3 hasAnchor" number="5.5.6">
<h3><span class="header-section-number">5.5.6</span> How is the operating modified to accomodate changes as specified in the future_OM_list?<a href="SSMSE.html#how-is-the-operating-modified-to-accomodate-changes-as-specified-in-the-future_om_list" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All changes are made by converting the parameter(s) with changes to be time varing by using additive annual parameter deviations. Because this is an operating model, Stock Synthesis is not run with estimation, so to get the changes into the OM, values (drawn or calculated in model_changes or specified by the user using “custom”) are directly input as parameter deviations into the ss.par file.</p>
<p>If an OM already contains time varying parameters, these parameters will also be converted to additive parameter deviations before applying the changes specified in the future_OM_list.</p>
</div>
<div id="example-of-specifying-recruitment-deviations" class="section level3 hasAnchor" number="5.5.7">
<h3><span class="header-section-number">5.5.7</span> Example of specifying recruitment deviations<a href="SSMSE.html#example-of-specifying-recruitment-deviations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This shows some code for putting recruitment deviations with a mean of 0 and the same standard deviation as the historical recruitment deviations in years 1 to 100:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="SSMSE.html#cb62-1" aria-hidden="true" tabindex="-1"></a>template_mod_change <span class="ot">&lt;-</span> <span class="fu">create_future_om_list</span>(<span class="at">list_length =</span> <span class="dv">1</span>)</span>
<span id="cb62-2"><a href="SSMSE.html#cb62-2" aria-hidden="true" tabindex="-1"></a>rec_dev_specify <span class="ot">&lt;-</span> template_mod_change[[<span class="dv">1</span>]]</span>
<span id="cb62-3"><a href="SSMSE.html#cb62-3" aria-hidden="true" tabindex="-1"></a>rec_dev_specify<span class="sc">$</span>pars <span class="ot">&lt;-</span> <span class="st">&quot;rec_devs&quot;</span></span>
<span id="cb62-4"><a href="SSMSE.html#cb62-4" aria-hidden="true" tabindex="-1"></a>rec_dev_specify<span class="sc">$</span>scen <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;replicate&quot;</span>, <span class="st">&quot;all&quot;</span>)</span>
<span id="cb62-5"><a href="SSMSE.html#cb62-5" aria-hidden="true" tabindex="-1"></a>rec_dev_specify<span class="sc">$</span>input<span class="sc">$</span>first_yr_averaging <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-6"><a href="SSMSE.html#cb62-6" aria-hidden="true" tabindex="-1"></a>rec_dev_specify<span class="sc">$</span>input<span class="sc">$</span>last_yr_averaging <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb62-7"><a href="SSMSE.html#cb62-7" aria-hidden="true" tabindex="-1"></a>rec_dev_specify<span class="sc">$</span>input<span class="sc">$</span>last_yr_orig_val <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb62-8"><a href="SSMSE.html#cb62-8" aria-hidden="true" tabindex="-1"></a>rec_dev_specify<span class="sc">$</span>input<span class="sc">$</span>first_yr_final_val <span class="ot">&lt;-</span> <span class="dv">101</span></span>
<span id="cb62-9"><a href="SSMSE.html#cb62-9" aria-hidden="true" tabindex="-1"></a>rec_dev_specify<span class="sc">$</span>input<span class="sc">$</span>ts_param <span class="ot">&lt;-</span> <span class="st">&quot;sd&quot;</span></span>
<span id="cb62-10"><a href="SSMSE.html#cb62-10" aria-hidden="true" tabindex="-1"></a>rec_dev_specify<span class="sc">$</span>input<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb62-11"><a href="SSMSE.html#cb62-11" aria-hidden="true" tabindex="-1"></a>rec_dev_list <span class="ot">&lt;-</span> <span class="fu">list</span>(rec_dev_specify)</span>
<span id="cb62-12"><a href="SSMSE.html#cb62-12" aria-hidden="true" tabindex="-1"></a>rec_dev_list</span></code></pre></div>
<pre><code>[[1]]
[[1]]$pars
[1] &quot;rec_devs&quot;

[[1]]$scen
[1] &quot;replicate&quot; &quot;all&quot;      

[[1]]$pattern
[1] &quot;model_change&quot;

[[1]]$input
  first_yr_averaging last_yr_averaging last_yr_orig_val first_yr_final_val
1                  1               100              100                101
  ts_param   method value
1       sd absolute    NA</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="M-case-study-ex.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="helper.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
